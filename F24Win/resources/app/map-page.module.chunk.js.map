{"version":3,"sources":["C:/Users/andreygolubkow/WebstormProjects/OperatorApp/src/app/layout/map-page/map-page-routing.module.ts","C:/Users/andreygolubkow/WebstormProjects/OperatorApp/src/app/layout/map-page/map-page.component.html","C:/Users/andreygolubkow/WebstormProjects/OperatorApp/src/app/layout/map-page/map-page.component.ts","C:/Users/andreygolubkow/WebstormProjects/OperatorApp/src/app/layout/map-page/map-page.module.ts"],"names":[],"mappings":"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","file":"map-page.module.chunk.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\nimport { MapPageComponent } from './map-page.component';\r\n\r\nconst routes: Routes = [\r\n    {\r\n        path: '',\r\n        component: MapPageComponent\r\n    }\r\n];\r\n\r\n@NgModule({\r\n    imports: [RouterModule.forChild(routes)],\r\n    exports: [RouterModule]\r\n})\r\nexport class MapPageRoutingModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// C:/Users/andreygolubkow/WebstormProjects/OperatorApp/src/app/layout/map-page/map-page-routing.module.ts","module.exports = \"<div  style=\\\"height: 600px; width: 100%;\\\">\\r\\n    <app-map #map style=\\\"height: 100%; width: 100%;\\\" ></app-map>\\r\\n</div>\\r\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// C:/Users/andreygolubkow/WebstormProjects/OperatorApp/src/app/layout/map-page/map-page.component.html\n// module id = ../../../../../src/app/layout/map-page/map-page.component.html\n// module chunks = map-page.module","import {Component, OnInit, ViewChild} from '@angular/core';\r\nimport {DepartmentService} from '../../shared/services/DepartmentService';\r\nimport {HydrantService} from '../../shared/services/HydrantService';\r\nimport {DepartureService} from '../../shared/services/DepartureService';\r\nimport {GpsPoint} from '../../shared/modules/map-module/GpsPoint';\r\nimport {MapComponent} from '../../shared/modules/map-module/map.component';\r\nimport {Department} from '../../shared/models/Department';\r\nimport {Departure} from '../../shared/models/Departure';\r\nimport {Hydrant} from '../../shared/models/Hydrant';\r\nimport {Observable} from 'rxjs/Observable';\r\nimport {forEach} from '@angular/router/src/utils/collection';\r\nimport {FireService} from '../../shared/services/FireService';\r\nimport {FireCarService} from '../../shared/services/FireCarService';\r\nimport {AuthService} from '../../shared/services/AuthService';\r\n\r\n@Component({\r\n    selector: 'app-map-page',\r\n    templateUrl: './map-page.component.html',\r\n    providers: [ DepartureService, DepartmentService, HydrantService, FireService, FireCarService]\r\n})\r\nexport class MapPageComponent implements OnInit {\r\n    @ViewChild('map') _map: MapComponent;\r\n\r\n    private _departments: L.Marker[] = [];\r\n    private _departures: L.Marker[] = [];\r\n    private _firecars: L.Marker[] = [];\r\n    private _fires: L.Marker[] = [];\r\n    private _hydrants: L.Marker[] = [];\r\n\r\n    constructor(private _departureService: DepartureService,\r\n                private _departmentService: DepartmentService,\r\n                private _fireService: FireService,\r\n                private _firecarService: FireCarService,\r\n                private _auth: AuthService,\r\n                private _hydrantService: HydrantService) {}\r\n\r\n    ngOnInit() {\r\n        this.DrawMarkers();\r\n        this._auth.CheckToken(this._auth.ReadLocalToken()).subscribe(data => {\r\n            this._map.SetViewCenter(data.geoZone);\r\n        })\r\n    }\r\n\r\n    DrawMarkers() {\r\n        this._departureService.getDepartures().subscribe(\r\n            data => {\r\n                for (const d of this._departures) {\r\n                    this._map.RemoveMarker(d);\r\n                }\r\n                this._departures = [];\r\n                for (const d of data) {\r\n                    const marker = this._map.AddIcon(d.gpsPoint, 'assets/images/departureMapIcon.png');\r\n                    marker.bindPopup(\"<p>\"+ d.address + \"</p><p>\"+d.intent+ \"</p><p>\" + d.comments+\"</p>\");\r\n                    this._departures.push(marker);\r\n                }\r\n            }\r\n        );\r\n        this._firecarService.getFireCars().subscribe(\r\n            data => {\r\n                for (const d of this._firecars) {\r\n                    this._map.RemoveMarker(d);\r\n                }\r\n                this._firecars = [];\r\n                for (const d of data) {\r\n                    const marker = this._map.AddIcon(d.gpsPoint, 'assets/images/firecarMapIcon.png');\r\n                    marker.bindPopup(\"<p>\"+ d.name + \"</p><p>\"+d.specialization+ \"</p><p>\" + d.num+\"</p>\");\r\n                    this._firecars.push(marker);\r\n                }\r\n            }\r\n        );\r\n        this._fireService.getFires().subscribe(\r\n            data => {\r\n                for (const d of this._fires) {\r\n                    this._map.RemoveMarker(d);\r\n                }\r\n                this._fires = [];\r\n                for (const d of data) {\r\n                    const marker = this._map.AddIcon(d.gpsPoint, 'assets/images/fireMapIcon.png');\r\n                    marker.bindPopup(\"<p>\"+ d.address + \"</p><p>\"+d.department.name+ \"</p><p>\" + d.comments\r\n                        + \"</p><p>R:\" + d.rank+\"</p>\");\r\n                    this._fires.push(marker);\r\n                }\r\n            }\r\n        );\r\n        this._departmentService.getDepartments().subscribe(\r\n            data => {\r\n                for (const d of this._departments) {\r\n                    this._map.RemoveMarker(d);\r\n                }\r\n                this._departments = [];\r\n                for (const d of data) {\r\n                    const marker = this._map.AddIcon(d.gpsPoint, 'assets/images/departmentMapIcon.png');\r\n                    marker.bindPopup(\"<p>\"+ d.name + \"</p><p>\"+d.address+ \"</p>\");\r\n                    this._departments.push(marker);\r\n                }\r\n            }\r\n        );\r\n        this._hydrantService.getHydrants().subscribe(\r\n            data => {\r\n                for (const d of this._hydrants) {\r\n                    this._map.RemoveMarker(d);\r\n                }\r\n                this._hydrants = [];\r\n                for (const d of data) {\r\n                    const active = 'assets/images/hydrantMapActive.png';\r\n                    const inactive = 'assets/images/hydrantMapInactive.png';\r\n                    const marker = this._map.AddIcon(d.gpsPoint, d.active ? active : inactive);\r\n                    marker.bindPopup(\"<p>\"+ d.waterType + \"</p><p>\"+d.description+ \"</p><p>\" + d.responsible\r\n                        + \"</p><p>\" + d.revisionDate+\"</p>\");\r\n                    this._hydrants.push(marker);\r\n                }\r\n            }\r\n        );\r\n    }\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// C:/Users/andreygolubkow/WebstormProjects/OperatorApp/src/app/layout/map-page/map-page.component.ts","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\n\r\nimport { MapPageRoutingModule} from './map-page-routing.module';\r\nimport { MapPageComponent } from './map-page.component';\r\nimport {MapModule} from '../../shared/modules/map-module/map.module';\r\n\r\n\r\n@NgModule({\r\n    imports: [CommonModule, MapPageRoutingModule, MapModule],\r\n    declarations: [MapPageComponent]\r\n})\r\nexport class MapPageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// C:/Users/andreygolubkow/WebstormProjects/OperatorApp/src/app/layout/map-page/map-page.module.ts"],"sourceRoot":"webpack:///"}